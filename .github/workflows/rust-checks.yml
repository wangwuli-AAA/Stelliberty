name: Rust ä»£ç æ£€æŸ¥

on:
  pull_request:
    types: [opened, synchronize, reopened]
  workflow_dispatch:

jobs:
  rust-checks:
    name: ${{ matrix.os }}
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v6

      - name: é…ç½® Rust
        uses: dtolnay/rust-toolchain@stable

      - name: æ£€æŸ¥ Rust ä»£ç æ ¼å¼
        working-directory: native/hub
        shell: bash
        run: |
          echo "ğŸ” æ£€æŸ¥ Rust ä»£ç æ ¼å¼..."
          if ! cargo fmt -- --check; then
            echo ""
            echo "âŒ Rust ä»£ç æ ¼å¼ä¸è§„èŒƒï¼"
            echo ""
            echo "è¯·åœ¨æœ¬åœ°è¿è¡Œä»¥ä¸‹å‘½ä»¤ä¿®å¤ï¼š"
            echo "  cd native/hub"
            echo "  cargo fmt"
            echo ""
            exit 1
          fi
          echo "âœ… Rust ä»£ç æ ¼å¼æ£€æŸ¥é€šè¿‡"

      - name: æ£€æŸ¥ Rust ä»£ç è´¨é‡
        working-directory: native/hub
        shell: bash
        run: |
          echo "ğŸ” è¿è¡Œ Clippy æ£€æŸ¥..."
          cargo clippy --all-targets -- -D warnings
          echo "âœ… Clippy æ£€æŸ¥é€šè¿‡"